FROM python:3.9-buster
RUN pip3 -q install pip --upgrade
# RUN set -xe \
#     && apt-get update \
#     && apt-get install python-pip
# RUN pip install --upgrade pip

RUN pip3 install tensorflow && \
	pip3 install numpy pandas sklearn matplotlib seaborn jupyter && \
	pip3 install keras && \
	pip3 install opencv-python && \
	pip3 install random && \
	pip3 install imblearn

WORKDIR /Users/zakijefferson/code/Threat-Detection
COPY . .

RUN pip install jupyter

WORKDIR /Users/zakijefferson/code/Threat-Detection

# Add Tini. Tini operates as a process subreaper for jupyter. This prevents kernel crashes.
ENV TINI_VERSION v0.6.0
ADD https://github.com/krallin/tini/releases/download/${TINI_VERSION}/tini /usr/bin/tini
RUN chmod +x /usr/bin/tini
ENTRYPOINT ["/usr/bin/tini", "--"]

CMD ["jupyter", "notebook", "--port=8888", "--no-browser", "--ip=0.0.0.0", "--allow-root"]